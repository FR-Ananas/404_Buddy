<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Connexion - 404Buddy</title>
  <link rel="stylesheet" href="/style.css" />
</head>
<body class="login-body">
  <div id="loginScreen" class="login-screen">
    <div id="loginBox" class="login-box">
      <h2>Connexion à 404Buddy</h2>
      <input type="text" id="loginName" placeholder="Ton pseudo" class="login-input">
      <label id="customFile" for="loginPic" class="file-btn">Choisir une image</label>
      <input type="file" id="loginPic" accept="image/*" class="file-hidden">
      <span id="fileLabelText" class="file-label">Aucune image sélectionnée</span>
      <button onclick="start()" class="login-button">Se connecter</button>
    </div>
  </div>

  <script>
    document.getElementById('loginPic').addEventListener('change', function () {
      const label = document.getElementById('fileLabelText');
      label.textContent = this.files.length ? "Image sélectionnée : " + this.files[0].name : "Aucune image sélectionnée";
    });

    function start() {
      const name = document.getElementById('loginName').value;
      const file = document.getElementById('loginPic').files[0];
      if (!name || !file) {
        alert("Entre un pseudo ET une image !");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        localStorage.setItem("pseudo", name);
        localStorage.setItem("avatar", e.target.result);
        window.location.href = "/chat.html";
      };
      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>
